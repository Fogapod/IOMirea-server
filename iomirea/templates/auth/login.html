<!DOCTYPE html>
<head>
	<meta charset="utf-8" />
	<title>Authorization</title>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript">

     	$(function() {
		var redirect = "{{ redirect }}"

		var xhr = new XMLHttpRequest();

		xhr.onreadystatechange = function() {
			if (this.readyState !== XMLHttpRequest.DONE) {
				return
			}
			if (this.status === 401) {
				alert('Wrong login or password')
			} else if (this.status === 200) {
				window.location.assign(redirect)
			} else {
				alert('Something went terribly wrong. Please, try to refresh page or return back later')
			}
		}

		$('#auth_form').on('submit', function(e) {
			// TODO: let user modify scope
			xhr.open("POST", window.location.href, true)
			xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			xhr.send("login="+$("#login_field").val()+"&password="+$("#password_field").val())
		})
	});
	</script>
	<style>body { background: #ffd999 /* Цвет фона */}</style>
</head>
<body>
	<header style="background-color: #F5B530;">
		<span 
			style="color: #FF8C00; font-size: 170%; font-family: 'Lucida Grande', 'Lucida Sans Unicode', 'Lucida Sans', 'DejaVu Sans', Verdana, sans-serif;">
			<img src="https://iomirea.ml/logo.png" width="100" height="95" alt=""/>
			<span style="text-align: left; color: #6A5ACD;">IOMirea</span>
		</span>
	</header>
	<form id="auth_form" onsubmit="return false">
		<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p>
		<table width="200" border="1" align="center">
			<tbody>
				<tr>
					<td bgcolor="#ffb959" style="text-align: center; color: #FFFFFF;">
						<p>Login<br>
						<input type="text" id="login_field" name="login">
						<br>Password<br>
						<input type="text" id="password_field" name="password">
						<p></p>
						<span style="text-align: center"></span>
						<input type="submit" value="login">
					</td>
				</tr>
			</tbody>
		</table>
	</form>
</body>
